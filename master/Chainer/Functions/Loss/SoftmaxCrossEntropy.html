<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Chainer::Functions::Loss::SoftmaxCrossEntropy
  
    &mdash; Documentation by YARD 0.9.20
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Chainer::Functions::Loss::SoftmaxCrossEntropy";
  relpath = '../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>



    <!-- Additional settings for MathJax are from here. -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax:{
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
        }
      });
    </script>
    <script type="text/javascript"
      src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS_HTML">
    </script>
    <meta http-equiv="X-UA-Compatible" CONTENT="IE=EmulateIE7" />
    <!-- Additional settings for MathJax are over here. -->

  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Chainer.html" title="Chainer (module)">Chainer</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Functions.html" title="Chainer::Functions (module)">Functions</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Loss.html" title="Chainer::Functions::Loss (module)">Loss</a></span></span>
     &raquo; 
    <span class="title">SoftmaxCrossEntropy</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Chainer::Functions::Loss::SoftmaxCrossEntropy
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="../../Function.html" title="Chainer::Function (class)">Chainer::Function</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="../../Function.html" title="Chainer::Function (class)">Chainer::Function</a></span></li>
          
            <li class="next">Chainer::Functions::Loss::SoftmaxCrossEntropy</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/chainer/functions/loss/softmax_cross_entropy.rb</dd>
  </dl>
  
</div>







  <h2>Instance Attribute Summary</h2>
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="../../Function.html" title="Chainer::Function (class)">Chainer::Function</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Function.html#inputs-instance_method" title="Chainer::Function#inputs (method)">#inputs</a></span>, <span class='object_link'><a href="../../Function.html#output_data-instance_method" title="Chainer::Function#output_data (method)">#output_data</a></span>, <span class='object_link'><a href="../../Function.html#outputs-instance_method" title="Chainer::Function#outputs (method)">#outputs</a></span>, <span class='object_link'><a href="../../Function.html#owned_node-instance_method" title="Chainer::Function#owned_node (method)">#owned_node</a></span>, <span class='object_link'><a href="../../Function.html#rank-instance_method" title="Chainer::Function#rank (method)">#rank</a></span>, <span class='object_link'><a href="../../Function.html#retain_after_backward-instance_method" title="Chainer::Function#retain_after_backward (method)">#retain_after_backward</a></span></p>


  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#check_class_weight_option-class_method" title="check_class_weight_option (class method)">.<strong>check_class_weight_option</strong>(class_weight)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#check_reduce_option-class_method" title="check_reduce_option (class method)">.<strong>check_reduce_option</strong>(reduce)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#double_backward_softmax_cross_entropy-class_method" title="double_backward_softmax_cross_entropy (class method)">.<strong>double_backward_softmax_cross_entropy</strong>(x, t, normalize, class_weight, ignore_label, reduce)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#softmax_cross_entropy-class_method" title="softmax_cross_entropy (class method)">.<strong>softmax_cross_entropy</strong>(x, t, normalize: true, cache_score: true, class_weight: nil, ignore_label: -1,, reduce: &#39;mean&#39;, enable_double_backprop: false)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#backward-instance_method" title="#backward (instance method)">#<strong>backward</strong>(inputs, grad_outputs)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#forward-instance_method" title="#forward (instance method)">#<strong>forward</strong>(inputs)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(normalize: true, cache_score: true, class_weight: nil, ignore_label: -1,, reduce: &#39;mean&#39;)  &#x21d2; SoftmaxCrossEntropy </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of SoftmaxCrossEntropy.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="../../Function.html" title="Chainer::Function (class)">Chainer::Function</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Function.html#backward_cpu-instance_method" title="Chainer::Function#backward_cpu (method)">#backward_cpu</a></span>, <span class='object_link'><a href="../../Function.html#backward_gpu-instance_method" title="Chainer::Function#backward_gpu (method)">#backward_gpu</a></span>, <span class='object_link'><a href="../../Function.html#call-instance_method" title="Chainer::Function#call (method)">#call</a></span>, <span class='object_link'><a href="../../Function.html#forward_cpu-instance_method" title="Chainer::Function#forward_cpu (method)">#forward_cpu</a></span>, <span class='object_link'><a href="../../Function.html#forward_gpu-instance_method" title="Chainer::Function#forward_gpu (method)">#forward_gpu</a></span>, <span class='object_link'><a href="../../Function.html#label-instance_method" title="Chainer::Function#label (method)">#label</a></span>, <span class='object_link'><a href="../../Function.html#node-instance_method" title="Chainer::Function#node (method)">#node</a></span>, <span class='object_link'><a href="../../Function.html#retain_inputs-instance_method" title="Chainer::Function#retain_inputs (method)">#retain_inputs</a></span>, <span class='object_link'><a href="../../Function.html#retain_outputs-instance_method" title="Chainer::Function#retain_outputs (method)">#retain_outputs</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(normalize: true, cache_score: true, class_weight: nil, ignore_label: -1,, reduce: &#39;mean&#39;)  &#x21d2; <tt><span class='object_link'><a href="" title="Chainer::Functions::Loss::SoftmaxCrossEntropy (class)">SoftmaxCrossEntropy</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of SoftmaxCrossEntropy</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


57
58
59
60
61
62
63
64
65
66
67</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/chainer/functions/loss/softmax_cross_entropy.rb', line 57</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='label'>normalize:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>cache_score:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>class_weight:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>ignore_label:</span> <span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span> <span class='label'>reduce:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mean</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='ivar'>@normalize</span> <span class='op'>=</span> <span class='id identifier rubyid_normalize'>normalize</span>
  <span class='ivar'>@cache_score</span> <span class='op'>=</span> <span class='id identifier rubyid_cache_score'>cache_score</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_check_class_weight_option'>check_class_weight_option</span><span class='lparen'>(</span><span class='id identifier rubyid_class_weight'>class_weight</span><span class='rparen'>)</span>
  <span class='ivar'>@class_weight</span> <span class='op'>=</span> <span class='id identifier rubyid_class_weight'>class_weight</span>

  <span class='ivar'>@ignore_label</span> <span class='op'>=</span> <span class='id identifier rubyid_ignore_label'>ignore_label</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_check_reduce_option'>check_reduce_option</span><span class='lparen'>(</span><span class='id identifier rubyid_reduce'>reduce</span><span class='rparen'>)</span>
  <span class='ivar'>@reduce</span> <span class='op'>=</span> <span class='id identifier rubyid_reduce'>reduce</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="check_class_weight_option-class_method">
  
    .<strong>check_class_weight_option</strong>(class_weight)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


167
168
169
170
171
172
173
174
175
176
177
178</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/chainer/functions/loss/softmax_cross_entropy.rb', line 167</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_check_class_weight_option'>check_class_weight_option</span><span class='lparen'>(</span><span class='id identifier rubyid_class_weight'>class_weight</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_class_weight'>class_weight</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

  <span class='id identifier rubyid_xm'>xm</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Chainer.html" title="Chainer (module)">Chainer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_array_module'><span class='object_link'><a href="../../../Chainer.html#get_array_module-class_method" title="Chainer.get_array_module (method)">get_array_module</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_class_weight'>class_weight</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_class_weight'>class_weight</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span> <span class='op'>!=</span> <span class='int'>1</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>class_weight.ndim should be 1</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>elsif</span> <span class='lparen'>(</span><span class='id identifier rubyid_class_weight'>class_weight</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>!=</span> <span class='id identifier rubyid_xm'>xm</span><span class='op'>::</span><span class='const'>DFloat</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='id identifier rubyid_class_weight'>class_weight</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>!=</span> <span class='id identifier rubyid_xm'>xm</span><span class='op'>::</span><span class='const'>SFloat</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The dtype of class_weight should be &#39;DFloat&#39; or &#39;SFloat&#39;, but was </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_class_weight'>class_weight</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_class_weight'>class_weight</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../../Chainer.html" title="Chainer (module)">Chainer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Variable.html" title="Chainer::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>class_weight should be a NArray, not a chainer.Variable</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="check_reduce_option-class_method">
  
    .<strong>check_reduce_option</strong>(reduce)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


180
181
182
183
184</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/chainer/functions/loss/softmax_cross_entropy.rb', line 180</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_check_reduce_option'>check_reduce_option</span><span class='lparen'>(</span><span class='id identifier rubyid_reduce'>reduce</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mean</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>no</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_reduce'>reduce</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>only &#39;mean&#39; and &#39;no&#39; are valid for &#39;reduce&#39;, but </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_reduce'>reduce</span><span class='embexpr_end'>}</span><span class='tstring_content'> is given</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="double_backward_softmax_cross_entropy-class_method">
  
    .<strong>double_backward_softmax_cross_entropy</strong>(x, t, normalize, class_weight, ignore_label, reduce)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/chainer/functions/loss/softmax_cross_entropy.rb', line 13</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_double_backward_softmax_cross_entropy'>double_backward_softmax_cross_entropy</span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_t'>t</span><span class='comma'>,</span> <span class='id identifier rubyid_normalize'>normalize</span><span class='comma'>,</span> <span class='id identifier rubyid_class_weight'>class_weight</span><span class='comma'>,</span> <span class='id identifier rubyid_ignore_label'>ignore_label</span><span class='comma'>,</span> <span class='id identifier rubyid_reduce'>reduce</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../../Chainer.html" title="Chainer (module)">Chainer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Variable.html" title="Chainer::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_t'>t</span> <span class='op'>=</span>  <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span>
  <span class='kw'>end</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_check_class_weight_option'>check_class_weight_option</span><span class='lparen'>(</span><span class='id identifier rubyid_class_weight'>class_weight</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_check_reduce_option'>check_reduce_option</span><span class='lparen'>(</span><span class='id identifier rubyid_reduce'>reduce</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_loss'>loss</span> <span class='op'>=</span> <span class='op'>-</span><span class='const'><span class='object_link'><a href="../Activation.html" title="Chainer::Functions::Activation (module)">Activation</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Activation/LogSoftmax.html" title="Chainer::Functions::Activation::LogSoftmax (class)">LogSoftmax</a></span></span><span class='period'>.</span><span class='id identifier rubyid_log_softmax'><span class='object_link'><a href="../Activation/LogSoftmax.html#log_softmax-class_method" title="Chainer::Functions::Activation::LogSoftmax.log_softmax (method)">log_softmax</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_class_weight'>class_weight</span>
    <span class='id identifier rubyid_shape'>shape</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_d'>d</span><span class='op'>|</span> <span class='id identifier rubyid_d'>d</span> <span class='op'>!=</span> <span class='int'>1</span> <span class='op'>?</span> <span class='int'>1</span> <span class='op'>:</span> <span class='id identifier rubyid_class_weight'>class_weight</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_class_weight'>class_weight</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Chainer.html" title="Chainer (module)">Chainer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Functions.html" title="Chainer::Functions (module)">Functions</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Array.html" title="Chainer::Functions::Array (module)">Array</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Array/BroadcastTo.html" title="Chainer::Functions::Array::BroadcastTo (class)">BroadcastTo</a></span></span><span class='period'>.</span><span class='id identifier rubyid_broadcast_to'><span class='object_link'><a href="../Array/BroadcastTo.html#broadcast_to-class_method" title="Chainer::Functions::Array::BroadcastTo.broadcast_to (method)">broadcast_to</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_class_weight'>class_weight</span><span class='period'>.</span><span class='id identifier rubyid_reshape'>reshape</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_shape'>shape</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_loss'>loss</span> <span class='op'>=</span> <span class='id identifier rubyid_loss'>loss</span> <span class='op'>*</span> <span class='id identifier rubyid_class_weight'>class_weight</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_dtype'>dtype</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../../Chainer.html" title="Chainer (module)">Chainer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Variable.html" title="Chainer::Variable (class)">Variable</a></span></span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_dtype'>dtype</span> <span class='op'>:</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span>
  <span class='id identifier rubyid_in_use'>in_use</span> <span class='op'>=</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_ne'>ne</span><span class='lparen'>(</span><span class='id identifier rubyid_ignore_label'>ignore_label</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_cast_to'>cast_to</span><span class='lparen'>(</span><span class='id identifier rubyid_dtype'>dtype</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_loss'>loss</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Chainer.html" title="Chainer (module)">Chainer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Functions.html" title="Chainer::Functions (module)">Functions</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Array.html" title="Chainer::Functions::Array (module)">Array</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Array/Rollaxis.html" title="Chainer::Functions::Array::Rollaxis (class)">Rollaxis</a></span></span><span class='period'>.</span><span class='id identifier rubyid_rollaxis'><span class='object_link'><a href="../Array/Rollaxis.html#rollaxis-class_method" title="Chainer::Functions::Array::Rollaxis.rollaxis (method)">rollaxis</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_loss'>loss</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>start:</span>  <span class='id identifier rubyid_loss'>loss</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span><span class='rparen'>)</span>

  <span class='comment'># TODO: loss = chainer.functions.reshape(loss, (-1, loss.shape[-1]))
</span>  <span class='id identifier rubyid_shape'>shape</span> <span class='op'>=</span> <span class='id identifier rubyid_loss'>loss</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span>
  <span class='id identifier rubyid_last_shape'>last_shape</span> <span class='op'>=</span> <span class='id identifier rubyid_shape'>shape</span><span class='period'>.</span><span class='id identifier rubyid_pop'>pop</span>
  <span class='id identifier rubyid_loss'>loss</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Chainer.html" title="Chainer (module)">Chainer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Functions.html" title="Chainer::Functions (module)">Functions</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Array.html" title="Chainer::Functions::Array (module)">Array</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Array/Reshape.html" title="Chainer::Functions::Array::Reshape (class)">Reshape</a></span></span><span class='period'>.</span><span class='id identifier rubyid_reshape'><span class='object_link'><a href="../Array/Reshape.html#reshape-class_method" title="Chainer::Functions::Array::Reshape.reshape (method)">reshape</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_loss'>loss</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='id identifier rubyid_shape'>shape</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='symbol'>:*</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_last_shape'>last_shape</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='comment'># Replace ignore_label value with one valid for F.select_item below.
</span>  <span class='id identifier rubyid_t'>t</span> <span class='op'>=</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_clip'>clip</span><span class='lparen'>(</span><span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_loss'>loss</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>-</span> <span class='int'>1</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_loss'>loss</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Chainer.html" title="Chainer (module)">Chainer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Functions.html" title="Chainer::Functions (module)">Functions</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Array.html" title="Chainer::Functions::Array (module)">Array</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Array/SelectItem.html" title="Chainer::Functions::Array::SelectItem (class)">SelectItem</a></span></span><span class='period'>.</span><span class='id identifier rubyid_select_item'><span class='object_link'><a href="../Array/SelectItem.html#select_item-class_method" title="Chainer::Functions::Array::SelectItem.select_item (method)">select_item</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_loss'>loss</span><span class='comma'>,</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_loss'>loss</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Chainer.html" title="Chainer (module)">Chainer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Functions.html" title="Chainer::Functions (module)">Functions</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Array.html" title="Chainer::Functions::Array (module)">Array</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Array/Reshape.html" title="Chainer::Functions::Array::Reshape (class)">Reshape</a></span></span><span class='period'>.</span><span class='id identifier rubyid_reshape'><span class='object_link'><a href="../Array/Reshape.html#reshape-class_method" title="Chainer::Functions::Array::Reshape.reshape (method)">reshape</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_loss'>loss</span><span class='comma'>,</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_loss'>loss</span> <span class='op'>=</span> <span class='id identifier rubyid_loss'>loss</span> <span class='op'>*</span> <span class='id identifier rubyid_in_use'>in_use</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_reduce'>reduce</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>mean</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_count'>count</span> <span class='op'>=</span> <span class='id identifier rubyid_normalize'>normalize</span> <span class='op'>?</span> <span class='id identifier rubyid_in_use'>in_use</span><span class='period'>.</span><span class='id identifier rubyid_sum'>sum</span> <span class='op'>:</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_count'>count</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_count'>count</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span><span class='comma'>,</span> <span class='float'>1.0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span>
    <span class='id identifier rubyid_loss'>loss</span> <span class='op'>=</span> <span class='id identifier rubyid_loss'>loss</span> <span class='op'>*</span> <span class='lparen'>(</span><span class='float'>1.0</span> <span class='op'>/</span> <span class='id identifier rubyid_count'>count</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="../../../Chainer.html" title="Chainer (module)">Chainer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Functions.html" title="Chainer::Functions (module)">Functions</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Math.html" title="Chainer::Functions::Math (module)">Math</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Math/Sum.html" title="Chainer::Functions::Math::Sum (class)">Sum</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sum'><span class='object_link'><a href="../Math/Sum.html#sum-class_method" title="Chainer::Functions::Math::Sum.sum (method)">sum</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_loss'>loss</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_loss'>loss</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="softmax_cross_entropy-class_method">
  
    .<strong>softmax_cross_entropy</strong>(x, t, normalize: true, cache_score: true, class_weight: nil, ignore_label: -1,, reduce: &#39;mean&#39;, enable_double_backprop: false)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5
6
7
8
9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/chainer/functions/loss/softmax_cross_entropy.rb', line 5</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_softmax_cross_entropy'>softmax_cross_entropy</span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_t'>t</span><span class='comma'>,</span> <span class='label'>normalize:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>cache_score:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>class_weight:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>ignore_label:</span> <span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span> <span class='label'>reduce:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mean</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>enable_double_backprop:</span> <span class='kw'>false</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_enable_double_backprop'>enable_double_backprop</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_double_backward_softmax_cross_entropy'>double_backward_softmax_cross_entropy</span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_t'>t</span><span class='comma'>,</span> <span class='id identifier rubyid_normalize'>normalize</span><span class='comma'>,</span> <span class='id identifier rubyid_class_weight'>class_weight</span><span class='comma'>,</span> <span class='id identifier rubyid_ignore_label'>ignore_label</span><span class='comma'>,</span> <span class='id identifier rubyid_reduce'>reduce</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='label'>normalize:</span> <span class='id identifier rubyid_normalize'>normalize</span><span class='comma'>,</span> <span class='label'>cache_score:</span> <span class='id identifier rubyid_cache_score'>cache_score</span><span class='comma'>,</span> <span class='label'>class_weight:</span> <span class='id identifier rubyid_class_weight'>class_weight</span><span class='comma'>,</span> <span class='label'>ignore_label:</span> <span class='id identifier rubyid_ignore_label'>ignore_label</span><span class='comma'>,</span> <span class='label'>reduce:</span> <span class='id identifier rubyid_reduce'>reduce</span><span class='rparen'>)</span><span class='period'>.</span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_t'>t</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="backward-instance_method">
  
    #<strong>backward</strong>(inputs, grad_outputs)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/chainer/functions/loss/softmax_cross_entropy.rb', line 107</span>

<span class='kw'>def</span> <span class='id identifier rubyid_backward'>backward</span><span class='lparen'>(</span><span class='id identifier rubyid_inputs'>inputs</span><span class='comma'>,</span> <span class='id identifier rubyid_grad_outputs'>grad_outputs</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_xm'>xm</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Chainer.html" title="Chainer (module)">Chainer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_array_module'><span class='object_link'><a href="../../../Chainer.html#get_array_module-class_method" title="Chainer.get_array_module (method)">get_array_module</a></span></span><span class='lparen'>(</span><span class='op'>*</span><span class='lparen'>(</span><span class='id identifier rubyid_inputs'>inputs</span> <span class='op'>+</span> <span class='id identifier rubyid_grad_outputs'>grad_outputs</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_t'>t</span> <span class='op'>=</span> <span class='id identifier rubyid_inputs'>inputs</span>
  <span class='id identifier rubyid_gloss'>gloss</span> <span class='op'>=</span> <span class='id identifier rubyid_grad_outputs'>grad_outputs</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>

  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_defined?'>instance_variable_defined?</span><span class='lparen'>(</span><span class='symbol'>:&#39;@y&#39;</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_y'>y</span> <span class='op'>=</span> <span class='ivar'>@y</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_y'>y</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Activation.html" title="Chainer::Functions::Activation (module)">Activation</a></span></span><span class='period'>.</span><span class='id identifier rubyid__log_softmax'><span class='object_link'><a href="../Activation.html#_log_softmax-class_method" title="Chainer::Functions::Activation._log_softmax (method)">_log_softmax</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_y'>y</span> <span class='op'>=</span> <span class='id identifier rubyid_xm'>xm</span><span class='op'>::</span><span class='const'>NMath</span><span class='period'>.</span><span class='id identifier rubyid_exp'>exp</span><span class='lparen'>(</span><span class='id identifier rubyid_y'>y</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_y'>y</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span> <span class='op'>==</span> <span class='int'>2</span>
    <span class='id identifier rubyid_gx'>gx</span> <span class='op'>=</span> <span class='id identifier rubyid_y'>y</span>
    <span class='comment'># TODO(sonots): Avoid to_a especially in Cumo to improve performance
</span>    <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_seq'>seq</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span><span class='period'>.</span><span class='id identifier rubyid_zip'>zip</span><span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_maximum'>maximum</span><span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='comma'>,</span> <span class='int'>0</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_gx'>gx</span><span class='lbracket'>[</span><span class='op'>*</span><span class='id identifier rubyid_v'>v</span><span class='rbracket'>]</span> <span class='op'>-=</span> <span class='int'>1</span><span class='rbrace'>}</span>

    <span class='kw'>if</span> <span class='ivar'>@class_weight</span>
      <span class='id identifier rubyid_shape'>shape</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_d'>d</span><span class='op'>|</span> <span class='id identifier rubyid_d'>d</span> <span class='op'>==</span> <span class='int'>1</span> <span class='op'>?</span> <span class='kw'>true</span> <span class='op'>:</span> <span class='int'>1</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Chainer.html" title="Chainer (module)">Chainer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Utils.html" title="Chainer::Utils (module)">Utils</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Utils/Array.html" title="Chainer::Utils::Array (module)">Array</a></span></span><span class='period'>.</span><span class='id identifier rubyid_broadcast_to'><span class='object_link'><a href="../../Utils/Array.html#broadcast_to-class_method" title="Chainer::Utils::Array.broadcast_to (method)">broadcast_to</a></span></span><span class='lparen'>(</span><span class='ivar'>@class_weight</span><span class='period'>.</span><span class='id identifier rubyid_reshape'>reshape</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_shape'>shape</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span><span class='lbracket'>[</span><span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_seq'>seq</span><span class='comma'>,</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_maximum'>maximum</span><span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='comma'>,</span> <span class='int'>0</span><span class='rparen'>)</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_diagonal'>diagonal</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
      <span class='id identifier rubyid_gx'>gx</span> <span class='op'>*=</span> <span class='const'><span class='object_link'><a href="../../../Chainer.html" title="Chainer (module)">Chainer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Utils.html" title="Chainer::Utils (module)">Utils</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Utils/Array.html" title="Chainer::Utils::Array (module)">Array</a></span></span><span class='period'>.</span><span class='id identifier rubyid_broadcast_to'><span class='object_link'><a href="../../Utils/Array.html#broadcast_to-class_method" title="Chainer::Utils::Array.broadcast_to (method)">broadcast_to</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_expand_dims'>expand_dims</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_gx'>gx</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='ivar'>@ignore_label</span>
      <span class='id identifier rubyid_gx'>gx</span> <span class='op'>*=</span> <span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_ne'>ne</span> <span class='ivar'>@ignore_label</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_reshape'>reshape</span><span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='comment'># in the case where y.ndim is higher than 2,
</span>    <span class='comment'># we think that a current implementation is inefficient
</span>    <span class='comment'># because it yields two provisional arrays for indexing.
</span>
    <span class='id identifier rubyid_n_unit'>n_unit</span> <span class='op'>=</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>/</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_gx'>gx</span> <span class='op'>=</span> <span class='id identifier rubyid_y'>y</span><span class='period'>.</span><span class='id identifier rubyid_reshape'>reshape</span><span class='lparen'>(</span><span class='id identifier rubyid_y'>y</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_fst_index'>fst_index</span> <span class='op'>=</span> <span class='id identifier rubyid_xm'>xm</span><span class='op'>::</span><span class='const'>Int32</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_seq'>seq</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span> <span class='op'>/</span> <span class='id identifier rubyid_n_unit'>n_unit</span>
    <span class='id identifier rubyid_trd_index'>trd_index</span> <span class='op'>=</span> <span class='id identifier rubyid_xm'>xm</span><span class='op'>::</span><span class='const'>Int32</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_seq'>seq</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span> <span class='op'>%</span> <span class='id identifier rubyid_n_unit'>n_unit</span>
    <span class='comment'># TODO(sonots): Avoid to_a especially in Cumo to improve performance
</span>    <span class='id identifier rubyid_fst_index'>fst_index</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span><span class='period'>.</span><span class='id identifier rubyid_zip'>zip</span><span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_maximum'>maximum</span><span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='comma'>,</span> <span class='int'>0</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span><span class='comma'>,</span> <span class='id identifier rubyid_trd_index'>trd_index</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_gx'>gx</span><span class='lbracket'>[</span><span class='op'>*</span><span class='id identifier rubyid_v'>v</span><span class='rbracket'>]</span> <span class='op'>-=</span> <span class='int'>1</span><span class='rbrace'>}</span>
    <span class='kw'>if</span> <span class='ivar'>@class_weight</span>
      <span class='id identifier rubyid_shape'>shape</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_d'>d</span><span class='op'>|</span> <span class='id identifier rubyid_d'>d</span> <span class='op'>==</span> <span class='int'>1</span> <span class='op'>?</span> <span class='kw'>true</span> <span class='op'>:</span> <span class='int'>1</span><span class='rbrace'>}</span>
      <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Chainer.html" title="Chainer (module)">Chainer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Utils.html" title="Chainer::Utils (module)">Utils</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Utils/Array.html" title="Chainer::Utils::Array (module)">Array</a></span></span><span class='period'>.</span><span class='id identifier rubyid_broadcast_to'><span class='object_link'><a href="../../Utils/Array.html#broadcast_to-class_method" title="Chainer::Utils::Array.broadcast_to (method)">broadcast_to</a></span></span><span class='lparen'>(</span><span class='ivar'>@class_weight</span><span class='period'>.</span><span class='id identifier rubyid_reshape'>reshape</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_shape'>shape</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_reshape'>reshape</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_gx'>gx</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span><span class='lbracket'>[</span><span class='id identifier rubyid_fst_index'>fst_index</span><span class='comma'>,</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_maximum'>maximum</span><span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='comma'>,</span> <span class='int'>0</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_trd_index'>trd_index</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_diagonal'>diagonal</span><span class='period'>.</span><span class='id identifier rubyid_diagonal'>diagonal</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
      <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_reshape'>reshape</span><span class='lparen'>(</span><span class='id identifier rubyid_y'>y</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_gx'>gx</span> <span class='op'>*=</span> <span class='const'><span class='object_link'><a href="../../../Chainer.html" title="Chainer (module)">Chainer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Utils.html" title="Chainer::Utils (module)">Utils</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Utils/Array.html" title="Chainer::Utils::Array (module)">Array</a></span></span><span class='period'>.</span><span class='id identifier rubyid_broadcast_to'><span class='object_link'><a href="../../Utils/Array.html#broadcast_to-class_method" title="Chainer::Utils::Array.broadcast_to (method)">broadcast_to</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_gx'>gx</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='ivar'>@ignore_label</span>
      <span class='id identifier rubyid_gx'>gx</span> <span class='op'>*=</span> <span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_ne'>ne</span> <span class='ivar'>@ignore_label</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_reshape'>reshape</span><span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_gx'>gx</span> <span class='op'>=</span> <span class='id identifier rubyid_gx'>gx</span><span class='period'>.</span><span class='id identifier rubyid_reshape'>reshape</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_y'>y</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='ivar'>@reduce</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mean</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_gx'>gx</span> <span class='op'>*=</span> <span class='id identifier rubyid_gloss'>gloss</span> <span class='op'>*</span> <span class='ivar'>@coeff</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_gx'>gx</span> <span class='op'>*=</span> <span class='id identifier rubyid_gloss'>gloss</span><span class='lbracket'>[</span><span class='kw'>true</span><span class='comma'>,</span><span class='symbol'>:-</span> <span class='comma'>,</span> <span class='kw'>false</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='lbracket'>[</span><span class='id identifier rubyid_gx'>gx</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="forward-instance_method">
  
    #<strong>forward</strong>(inputs)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/chainer/functions/loss/softmax_cross_entropy.rb', line 69</span>

<span class='kw'>def</span> <span class='id identifier rubyid_forward'>forward</span><span class='lparen'>(</span><span class='id identifier rubyid_inputs'>inputs</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_xm'>xm</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Chainer.html" title="Chainer (module)">Chainer</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_array_module'><span class='object_link'><a href="../../../Chainer.html#get_array_module-class_method" title="Chainer.get_array_module (method)">get_array_module</a></span></span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_inputs'>inputs</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_t'>t</span> <span class='op'>=</span> <span class='id identifier rubyid_inputs'>inputs</span>
  <span class='id identifier rubyid_log_y'>log_y</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Activation.html" title="Chainer::Functions::Activation (module)">Activation</a></span></span><span class='period'>.</span><span class='id identifier rubyid__log_softmax'><span class='object_link'><a href="../Activation.html#_log_softmax-class_method" title="Chainer::Functions::Activation._log_softmax (method)">_log_softmax</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='ivar'>@cache_score</span>
    <span class='ivar'>@y</span> <span class='op'>=</span> <span class='id identifier rubyid_xm'>xm</span><span class='op'>::</span><span class='const'>NMath</span><span class='period'>.</span><span class='id identifier rubyid_exp'>exp</span><span class='lparen'>(</span><span class='id identifier rubyid_log_y'>log_y</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='ivar'>@class_weight</span>
    <span class='id identifier rubyid_shape'>shape</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_ndim'>ndim</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span> <span class='op'>==</span> <span class='int'>1</span> <span class='op'>?</span> <span class='kw'>true</span> <span class='op'>:</span> <span class='int'>1</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_log_y'>log_y</span> <span class='op'>*=</span> <span class='const'><span class='object_link'><a href="../../../Chainer.html" title="Chainer (module)">Chainer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Utils.html" title="Chainer::Utils (module)">Utils</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Utils/Array.html" title="Chainer::Utils::Array (module)">Array</a></span></span><span class='period'>.</span><span class='id identifier rubyid_broadcast_to'><span class='object_link'><a href="../../Utils/Array.html#broadcast_to-class_method" title="Chainer::Utils::Array.broadcast_to (method)">broadcast_to</a></span></span><span class='lparen'>(</span><span class='ivar'>@class_weight</span><span class='period'>.</span><span class='id identifier rubyid_reshape'>reshape</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_shape'>shape</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_log_yd'>log_yd</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Chainer.html" title="Chainer (module)">Chainer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Utils.html" title="Chainer::Utils (module)">Utils</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Utils/Array.html" title="Chainer::Utils::Array (module)">Array</a></span></span><span class='period'>.</span><span class='id identifier rubyid_rollaxis'><span class='object_link'><a href="../../Utils/Array.html#rollaxis-class_method" title="Chainer::Utils::Array.rollaxis (method)">rollaxis</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_log_y'>log_y</span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_log_yd'>log_yd</span> <span class='op'>=</span> <span class='id identifier rubyid_log_yd'>log_yd</span><span class='period'>.</span><span class='id identifier rubyid_reshape'>reshape</span><span class='lparen'>(</span><span class='id identifier rubyid_log_yd'>log_yd</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='const'>ArgumentError</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_log_p'>log_p</span> <span class='op'>=</span> <span class='id identifier rubyid_log_yd'>log_yd</span><span class='lbracket'>[</span><span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_maximum'>maximum</span><span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='comma'>,</span> <span class='int'>0</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_seq'>seq</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_diagonal'>diagonal</span>
  <span class='kw'>if</span> <span class='ivar'>@ignore_label</span>
    <span class='id identifier rubyid_t_valid'>t_valid</span><span class='op'>=</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_ne'>ne</span><span class='lparen'>(</span><span class='ivar'>@ignore_label</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_log_p'>log_p</span> <span class='op'>*=</span> <span class='id identifier rubyid_t_valid'>t_valid</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='ivar'>@reduce</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mean</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>if</span> <span class='ivar'>@normalize</span> <span class='kw'>and</span> <span class='id identifier rubyid_t_valid'>t_valid</span>
      <span class='ivar'>@coeff</span> <span class='op'>=</span> <span class='float'>1.0</span> <span class='op'>/</span> <span class='id identifier rubyid_log_p'>log_p</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_maximum'>maximum</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../../Chainer.html" title="Chainer (module)">Chainer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Utils.html" title="Chainer::Utils (module)">Utils</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Utils/Array.html" title="Chainer::Utils::Array (module)">Array</a></span></span><span class='period'>.</span><span class='id identifier rubyid_force_array'><span class='object_link'><a href="../../Utils/Array.html#force_array-class_method" title="Chainer::Utils::Array.force_array (method)">force_array</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_t_valid'>t_valid</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_count'>count</span> <span class='op'>=</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
      <span class='ivar'>@coeff</span> <span class='op'>=</span> <span class='float'>1.0</span> <span class='op'>/</span> <span class='lbracket'>[</span><span class='id identifier rubyid_count'>count</span><span class='comma'>,</span> <span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_y'>y</span> <span class='op'>=</span> <span class='id identifier rubyid_log_p'>log_p</span><span class='period'>.</span><span class='id identifier rubyid_sum'>sum</span><span class='lparen'>(</span><span class='label'>keepdims:</span> <span class='kw'>true</span><span class='rparen'>)</span> <span class='op'>*</span> <span class='lparen'>(</span><span class='op'>-</span><span class='ivar'>@coeff</span><span class='rparen'>)</span>
    <span class='lbracket'>[</span><span class='id identifier rubyid_y'>y</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_cast'>cast</span><span class='lparen'>(</span><span class='id identifier rubyid_y'>y</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rbracket'>]</span>
  <span class='kw'>else</span>
    <span class='lbracket'>[</span><span class='op'>-</span><span class='id identifier rubyid_log_p'>log_p</span><span class='period'>.</span><span class='id identifier rubyid_reshape'>reshape</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_shape'>shape</span><span class='rparen'>)</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Oct 10 04:25:43 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.20 (ruby-2.6.3).
</div>

    </div>
  </body>
</html>
